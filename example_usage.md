# M7 Portfolio Monitor - 사용 예시 📖

## 🎯 주요 사용 시나리오

### 시나리오 1: 최근 1년 성과 분석

**목적**: 2024년 한 해 동안 M7 Dynamic 전략의 성과를 QQQ와 비교

**단계**:
1. 사이드바에서 **시작일**: `2024-01-01` 선택
2. **종료일**: `2024-12-31` 선택
3. **비교 벤치마크**: `QQQ (Nasdaq 100)` 선택
4. **"포트폴리오 분석 실행"** 버튼 클릭

**기대 결과**:
- 2024년 CAGR 및 변동성 확인
- QQQ 대비 초과 수익률 분석
- 주요 하락 시기 대응 확인

---

### 시나리오 2: 장기 성과 검증

**목적**: 2017년부터 현재까지 전체 기간 성과 측정

**단계**:
1. **시작일**: `2017-01-01` (M7 종목 공통 시작일)
2. **종료일**: `현재 날짜` (기본값)
3. **비교 벤치마크**: `M7 Equal Weight` 선택
4. 분석 실행

**확인 포인트**:
- 장기 CAGR 및 Sharpe Ratio
- 동적 리밸런싱의 효과
- Equal Weight 대비 MDD 개선 여부

---

### 시나리오 3: 위기 대응 능력 분석

**목적**: 2022년 하락장 시기 전략 성과 검증

**단계**:
1. **시작일**: `2022-01-01`
2. **종료일**: `2022-12-31`
3. **비교 벤치마크**: `M7 Equal Weight`
4. 분석 실행 후 **Drawdown 차트** 집중 분석

**분석 포인트**:
- MDD 비교
- 하락 시기 리밸런싱 빈도
- 회복 속도

---

## 📊 차트 해석 가이드

### 1. 누적 수익률 차트

```
📈 상승 추세선
- M7 Dynamic이 벤치마크보다 위: ✅ 초과 수익 발생
- 두 선의 간격이 벌어짐: 🚀 전략 효과 증가
```

**예시 해석**:
- 2020년 3월: 급격한 하락 후 빠른 회복
- 2021년: 지속적인 상승세
- 2022년: 하락 방어 효과 확인

### 2. Drawdown 차트

```
📉 0% 기준선 아래
- 빨간 영역이 작을수록: ✅ 하락폭 작음
- 회복 속도가 빠를수록: ✅ 전략 효과적
```

**좋은 신호**:
- Dynamic < Benchmark Drawdown
- 빠른 최고점 회복

### 3. 포트폴리오 구성 파이 차트

```
🎯 현재 리밸런싱 상태
- 큰 비중 종목: 최근 하락이 큰 종목
- 0% 비중: 상대적으로 강세인 종목
```

**리밸런싱 논리**:
- Drawdown > -30%인 종목에 60% 집중
- 나머지 40%는 다른 종목에 분산

### 4. 비중 변화 차트

```
📊 Area 차트 패턴
- 급격한 변화: 시장 변동성 증가 시기
- 안정적 패턴: 시장 안정기
- 종목 교체: 상대 강도 변화
```

---

## 💡 성과 지표 이해하기

### CAGR (연평균 성장률)

```
15% CAGR → 연평균 15% 수익
+5%p vs Benchmark → 벤치마크보다 연 5% 더 높음
```

**좋은 수준**:
- 절대 수익: 10-20% CAGR
- 상대 수익: +3-7%p vs Benchmark

### Sharpe Ratio (샤프 비율)

```
1.5 → 위험 1단위당 1.5단위 초과 수익
2.0+ → 매우 우수한 위험 조정 수익
```

**등급**:
- < 1.0: 보통
- 1.0-2.0: 좋음
- 2.0+: 매우 우수

### Max Drawdown (최대 낙폭)

```
-25% → 고점 대비 최대 25% 하락
-15% vs -30% → 벤치마크보다 15%p 방어
```

**참고 기준**:
- -20% 이내: 우수
- -20% ~ -30%: 양호
- -30% 초과: 개선 필요

### Calmar Ratio

```
CAGR / |MDD|
0.5+ → 양호
1.0+ → 우수
```

---

## 🔍 실전 분석 예시

### 예시 1: 2023년 성과 분석

**입력**:
- 기간: 2023-01-01 ~ 2023-12-31
- 벤치마크: QQQ

**결과 예시** (가상):
```
📊 성과 요약
- CAGR: 45.2% (+5.8%p vs QQQ)
- Sharpe: 1.85 (+0.22)
- MDD: -12.5% (+3.2%p)
- 연간 회전율: 180%

💡 해석:
- AI 붐으로 NVDA 비중 ↑
- QQQ 대비 초과 수익 달성
- 낮은 변동성 유지
```

### 예시 2: 리밸런싱 시점 분석

**2024년 11월 최신 리밸런싱** (가상):
```
🎯 포트폴리오 구성
- TSLA: 35% (최근 30% 하락)
- META: 25% (20% 하락)
- GOOGL: 20%
- AMZN: 15%
- Others: 5%

💡 전략 논리:
- TSLA의 큰 하락 → 높은 비중 배정
- NVDA, AAPL은 상대적 강세 → 비중 축소
```

---

## ⚠️ 주의사항

### 1. 데이터 신뢰성

```
✅ 사용 가능: 2017-01-01 이후
⚠️ 주의: 그 이전 데이터는 일부 종목 누락 가능
```

### 2. 실시간 vs 마감 기준

```
yfinance 데이터: 전일 종가 기준
→ 당일 리밸런싱은 다음 거래일 반영
```

### 3. 거래 비용 미포함

```
표시된 수익률: 이론적 수익률
실제 수익률 = 이론 수익률 - (회전율 × 거래비용)

예시:
- 연 180% 회전율
- 거래비용 0.1%
- 실제 차감: 약 -1.8%p
```

---

## 📥 데이터 활용 방법

### CSV 다운로드 후 활용

**1. 포트폴리오 데이터 (portfolio_values_YYYYMMDD.csv)**
```python
import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv('portfolio_values_20241111.csv')
df['Date'] = pd.to_datetime(df['Date'])
df.set_index('Date', inplace=True)

# 월별 수익률 계산
monthly_returns = df['M7_Dynamic'].resample('M').last().pct_change()
print(monthly_returns.describe())
```

**2. 비중 이력 (weight_history_YYYYMMDD.csv)**
```python
weights = pd.read_csv('weight_history_20241111.csv')
weights['date'] = pd.to_datetime(weights['date'])

# 종목별 평균 비중
avg_weights = weights[['AAPL', 'MSFT', 'GOOGL', 'AMZN', 
                        'NVDA', 'META', 'TSLA']].mean()
print(avg_weights.sort_values(ascending=False))
```

---

## 🎓 추가 학습 자료

### 전략 이해하기

1. **고점 대비 하락률 (Drawdown from Peak)**
   - 최근 3개월 고점 기준
   - 하락폭이 클수록 저평가 판단

2. **Weight Split (60%)**
   - 심각한 하락 종목(-30% 이하)에 60% 집중
   - 나머지 40%는 다른 종목 분산

3. **Monthly Rebalancing**
   - 매월 말 리밸런싱
   - 과도한 거래 방지

### 권장 독서

- "Quantitative Momentum" - Wesley Gray
- "Dynamic Asset Allocation" - Adam Butler
- Streamlit 공식 문서

---

**더 많은 질문이나 피드백은 GitHub Issues에 남겨주세요!** 🙋‍♂️